import pytest

from mrnarchitect.sequence import Sequence

TEST_DATA = {
    "ENSG00000176893": (
        "AUGACCCUGGGAUCCCUGGGAAACAGCAGCAGCAGCGUUUCUGCUACCUUCCUGCUGAGUGGCAUCCCUGGGCUGGAGCGCAUGCACAUCUGGAUCUCCAUCCCACUGUGCUUCAUGUAUCUGGUUUCCAUCCCGGGCAACUGCACAAUUCUUUUUAUCAUUAAAACAGAGCGCUCACUUCAUGAACCUAUGUAUCUCUUCCUGUCCAUGCUGGCUCUGAUUGACCUGGGUCUCUCCCUUUGCACUCUCCCUACAGUCCUGGGCAUCUUUUGGGUUGGAGCACGAGAAAUUAGCCAUGAUGCCUGCUUUGCUCAGCUCUUUUUCAUUCACUGCUUCUCCUUCCUCGAGUCCUCUGUGCUACUGUCUAUGGCCUUUGACCGCUUUGUGGCUAUCUGCCACCCCUUGCACUAUGUUUCCAUUCUCACCAACACAGUCAUUGGCAGGAUUGGCCUGGUCUCUCUGGGUCGUAGUGUAGCACUCAUUUUUCCAUUACCUUUUAUGCUCAAAAGAUUCCCCUAUUGUGGCUCCCCAGUUCUCUCACAUUCUUAUUGUCUCCACCAAGAAGUGAUGAAAUUGGCCUGUGCCGACAUGAAGGCCAACAGCAUCUACGGCAUGUUUGUCAUCGUCUCUACAGUGGGUAUAGACUCACUGCUCAUCCUCUUCUCUUAUGCUCUGAUCCUGCGCACCGUGCUGUCCAUCGCCUCCAGGGCUGAGAGAUUCAAGGCCCUUAACACCUGUGUUUCCCACAUCUGUGCUGUGCUGCUCUUCUACACUCCCAUGAUUGGCCUCUCUGUCAUCCAUCGCUUUGGAAAGCAGGCACCCCACCUGGUCCAGGUGGUCAUGGGUUUCAUGUAUCUUCUCUUUCCUCCUGUGAUGAAUCCCAUUGUCUACAGUGUGAAGACCAAACAGAUCCGGGAUCGAGUGACGCAUGCCUUUUGUUACUAA",
        -305.83,
    ),
    "ENSG00000198475": (
        "AUGGAGUCAGUUGUACCAGUGAAGGACAAGAAACUUCUGGAGGUCAAACUAGGGGAGCUGCCAAGCUGGAUCUUGAUGUGGGACUUCAGCCCUAGUGGCCUUGAUGGAGCGUUUCAAAGAGGUUACUACUGGUACUACAACAAGUACAUCAACGUGAAGAAGGGGAGCAUCUCGGGGUUUACCAUGGUGCUGGCAGGGUACAUGCUCUUCAUCUACUGCCUUUCCUACAAGGAGCUCAAGCACGAGCGGCUAUGCAAGUACCACUGA",
        -75.47,
    ),
    "ENSG00000044115": (
        "AUGACUGCUGUCCAUGCAGGCAACAUAAACUUCAAGUGGGAUCCUAAAAGUCUAGAGAUCAGGACUCUGGCAGUUGAGAGACUGUUGGAGCCUCUUGUUACACAGGUUACAACCCUUGUAAACACCAAUAGUAAAGGGCCCUCUAAUAAGAAGAGAGGUCGUUCUAAGAAGGCCCAUGUUUUGGCUGCAUCUGUUGAACAAGCAACUGAGAAUUUCUUGGAGAAGGGGGAUAAAAUUGCGAAGGAGAGCCAGUUUCUCAAGGAGGAGCUUGUGGCUGCUGUAGAAGAUGUUCGAAAACAAGGUGAUUUGAUGAAGGCUGCUGCAGGAGAGUUCGCAGAUGAUCCCUGCUCUUCUGUGAAGCGAGGCAACAUGGUUCGGGCAGCUCGAGCUUUGCUCUCUGCUGUUACCCGGUUGCUGAUUUUGGCUGACAUGGCAGAUGUCUACAAAUUACUUGUUCAGCUGAAAGUUGUGGAAGAUGGUAUCUUGAAGUUGAGGAAUGCUGGCAAUGAACAAGACUUAGGAAUCCAGUAUAAAGCCCUAAAACCUGAAGUGGAUAAGCUGAACAUUAUGGCAGCCAAAAGACAACAGGAAUUGAAAGAUGUUGGCCAUCGUGAUCAGAUGGCUGCAGCUAGAGGAAUCCUGCAGAAGAACGUUCCGAUCCUCUAUACUGCAUCCCAGGCAUGCCUACAGCACCCUGAUGUCGCAGCCUAUAAGGCCAACAGGGACCUGAUAUACAAGCAGCUGCAGCAGGCGGUCACAGGCAUUUCCAAUGCAGCCCAGGCCACUGCCUCAGACGAUGCCUCACAGCACCAGGGUGGAGGAGGAGGAGAACUGGCAUAUGCACUCAAUAACUUUGACAAACAAAUCAUUGUGGACCCCUUGAGCUUCAGCGAGGAGCGCUUUAGGCCUUCCCUGGAGGAGCGUCUGGAAAGCAUCAUUAGUGGGGCUGCCUUGAUGGCCGACUCGUCCUGCACGCGUGAUGACCGUCGUGAGCGAAUUGUGGCAGAGUGUAAUGCUGUCCGCCAGGCCCUGCAGGACCUGCUUUCGGAGUACAUGGGCAAUGCUGGACGUAAAGAAAGAAGUGAUGCACUCAAUUCUGCAAUAGAUAAAAUGACCAAGAAGACCAGGGACUUGCGUAGACAGCUCCGCAAAGCUGUCAUGGACCACGUUUCAGAUUCUUUCCUGGAAACCAAUGUUCCACUUUUGGUAUUGAUUGAAGCUGCAAAGAAUGGAAAUGAGAAAGAAGUUAAGGAGUAUGCCCAAGUUUUCCGUGAACAUGCCAACAAAUUGAUUGAGGUUGCCAACUUGGCCUGUUCCAUCUCAAAUAAUGAAGAAGGUGUAAAGCUUGUUCGAAUGUCUGCAAGCCAGUUAGAAGCCCUCUGUCCUCAGGUUAUUAAUGCUGCACUGGCUUUAGCAGCAAAACCACAGAGUAAACUGGCCCAAGAGAACAUGGAUCUUUUUAAAGAACAAUGGGAAAAACAAGUCCGUGUUCUCACAGAUGCUGUCGAUGACAUUACUUCCAUUGAUGACUUCUUGGCUGUCUCAGAGAAUCACAUUUUGGAAGAUGUGAACAAAUGUGUCAUUGCUCUCCAAGAGAAGGAUGUGGAUGGCCUGGACCGCACAGCUGGUGCAAUUCGAGGCCGGGCAGCCCGGGUCAUUCACGUAGUCACCUCAGAGAUGGACAACUAUGAGCCAGGAGUCUACACAGAGAAGGUUCUGGAAGCCACUAAGCUGCUCUCCAACACAGUCAUGCCACGUUUUACUGAGCAAGUAGAAGCAGCCGUGGAAGCCCUCAGCUCGGACCCUGCCCAGCCCAUGGAUGAGAAUGAGUUUAUCGAUGCUUCCCGCCUGGUAUAUGAUGGCAUCCGGGACAUCAGGAAAGCAGUGCUGAUGAUAAGGACCCCUGAGGAGUUGGAUGACUCUGACUUUGAGACAGAAGAUUUUGAUGUCAGAAGCAGGACGAGCGUCCAGACAGAAGACGAUCAGCUGAUAGCUGGCCAGAGUGCCCGGGCGAUCAUGGCUCAGCUUCCCCAGGAGCAAAAAGCGAAGAUUGCGGAACAGGUGGCCAGCUUCCAGGAAGAAAAGAGCAAGCUGGAUGCUGAAGUGUCCAAAUGGGACGACAGUGGCAAUGACAUCAUUGUGCUGGCCAAGCAGAUGUGCAUGAUUAUGAUGGAGAUGACAGACUUUACCCGAGGUAAAGGACCACUCAAAAAUACAUCGGAUGUCAUCAGUGCUGCCAAGAAAAUUGCUGAGGCAGGAUCCAGGAUGGACAAGCUUGGCCGCACCAUUGCAGACCAUUGCCCCGACUCGGCUUGCAAGCAGGACCUGCUGGCCUACCUGCAACGCAUCGCCCUCUACUGCCACCAGCUGAACAUCUGCAGCAAGGUCAAGGCCGAGGUGCAGAAUCUCGGCGGGGAGCUUGUUGUCUCUGGGAACUGUGACACCUGCGGGGCACUGCAAGGGCUGAAAGGCUGGCCUCCUCCCCUUUGCGCCACUCACUGGGUGGACAGCGCCAUGUCCCUGAUCCAGGCAGCCAAGAACUUGAUGAAUGCUGUGGUGCAGACAGUGAAGGCAUCCUACGUCGCCUCUACCAAAUACCAAAAGUCACAGGGUAUGGCUUCCCUCAACCUUCCUGCUGUGUCAUGGAAGAUGAAGGCACCAGAGAAAAAGCCAUUGGUGAAGAGAGAGAAACAGGAUGAGACACAGACCAAGAUUAAACGGGCAUCUCAGAAGAAGCACGUGAACCCGGUGCAGGCCCUCAGCGAGUUCAAAGCUAUGGACAGCAUCUAA",
        -948.53,
    ),
    "ENSG00000203601": (
        "AUGUGGUUCUCUCGUUCUACAUACCACAGGCUUAGACAACCACGAACCAGCUCGGAACCCUUCUUCUGUAUGAGCACUCAGGGAGUUGUCCCCUUAAAUUCAGAAUCAGGAUCCUAUCUGAUCCUUGCAUGGGGGACCGCUGAAGAAUUUGGUCUCCCAGAACUUGGUAGGAAAACAUUCUUUUUUUUUUGGAGAUGGUGUCUCUGUUGCCAGGCUGAAGUGCAGUGGUGUGAUCUCAGCUCACGGCAAUCUCUGUCUCCUGGGUUCAAGCAAUUCCCCUGCCUCAGCCUCCCGAGUAGCUGGGAUUACAGGCGCGUACCACCACAAGCAGCUAAUUUUUUGUAUUUUAGUAGAGACAGGGUUUCACCAUGUUGUCCAGGAUGGUCUCUAUCUCCUGACUACCUGACCCGCCCACCUUGGCCUGGGAUUACAGGCGUGAGCCACUGCGCCCGGCUGGAAGGAAAACAUUCUGAGUGA",
        -150.2,
    ),
    "ENSG00000196277": (
        "AUGGUCCAGCUGAGGAAGCUGCUCCGCGUCCUGACUUUGAUGAAGUUCCCCUGCUGCGUGCUGGAGGUGCUCCUGUGCGCGCUGGCGGCGGCGGCGCGCGGCCAGGAGAUGUACGCCCCGCACUCAAUCCGGAUCGAGGGGGACGUCACCCUCGGGGGGCUGUUCCCCGUGCACGCCAAGGGUCCCAGCGGAGUGCCCUGCGGCGACAUCAAGAGGGAAAACGGGAUCCACAGGCUGGAAGCGAUGCUCUACGCCCUGGACCAGAUCAACAGUGAUCCCAACCUACUGCCCAACGUGACGCUGGGCGCGCGGAUCCUGGACACUUGUUCCAGGGACACUUACGCGCUCGAACAGUCGCUUACUUUCGUCCAGGCGCUCAUCCAGAAGGACACCUCCGACGUGCGCUGCACCAACGGCGAACCGCCGGUUUUCGUCAAGCCGGAGAAAGUAGUUGGAGUGAUUGGGGCUUCGGGGAGUUCGGUCUCCAUCAUGGUAGCCAACAUCCUGAGGCUCUUCCAGAUCCCCCAGAUUAGUUAUGCAUCAACGGCACCCGAGCUAAGUGAUGACCGGCGCUAUGACUUCUUCUCUCGCGUGGUGCCACCCGAUUCCUUCCAAGCCCAGGCCAUGGUAGACAUUGUAAAGGCCCUAGGCUGGAAUUAUGUGUCUACCCUCGCAUCGGAAGGAAGUUAUGGAGAGAAAGGUGUGGAGUCCUUCACGCAGAUUUCCAAAGAGGCAGGUGGACUCUGCAUUGCCCAGUCCGUGAGAAUCCCCCAGGAACGCAAAGACAGGACCAUUGACUUUGAUAGAAUUAUCAAACAGCUCCUGGACACCCCCAACUCCAGGGCCGUCGUGAUUUUUGCCAACGAUGAGGAUAUAAAGCAGAUCCUUGCAGCAGCCAAAAGAGCUGACCAAGUUGGCCAUUUUCUUUGGGUGGGAUCAGACAGCUGGGGAUCCAAAAUAAACCCACUGCACCAGCAUGAAGAUAUCGCAGAAGGGGCCAUCACCAUUCAGCCCAAGCGAGCCACGGUGGAAGGGUUUGAUGCCUACUUUACGUCCCGUACACUUGAAAACAACAGAAGAAAUGUAUGGUUUGCCGAAUACUGGGAGGAAAACUUCAACUGCAAGUUGACGAUUAGUGGGUCAAAAAAAGAAGACACAGAUCGCAAAUGCACAGGACAGGAGAGAAUUGGAAAAGAUUCCAACUAUGAGCAGGAGGGUAAAGUCCAGUUCGUGAUUGACGCAGUCUAUGCUAUGGCUCACGCCCUUCACCACAUGAACAAGGAUCUCUGUGCUGACUACCGGGGUGUCUGCCCAGAGAUGGAGCAAGCUGGAGGCAAGAAGUUGCUGAAGUAUAUACGCAAUGUUAAUUUCAAUGGUAGUGCUGGCACUCCAGUGAUGUUUAACAAGAACGGGGAUGCACCUGGGCGUUAUGACAUCUUUCAGUACCAGACCACAAACACCAGCAACCCGGGUUACCGUCUGAUCGGGCAGUGGACAGACGAACUUCAGCUCAAUAUAGAAGACAUGCAGUGGGGUAAAGGAGUCCGAGAGAUACCCGCCUCAGUGUGCACACUACCAUGUAAGCCAGGACAGAGAAAGAAGACACAGAAAGGAACUCCUUGCUGUUGGACCUGUGAGCCUUGCGAUGGUUACCAGUACCAGUUUGAUGAGAUGACAUGCCAGCAUUGCCCCUAUGACCAGAGGCCCAAUGAAAAUCGAACCGGAUGCCAGGAUAUUCCCAUCAUCAAACUGGAGUGGCACUCCCCCUGGGCUGUGAUUCCUGUCUUCCUGGCAAUGUUGGGGAUCAUUGCCACCAUCUUUGUCAUGGCCACUUUCAUCCGCUACAAUGACACGCCCAUUGUCCGGGCAUCUGGGCGGGAACUCAGCUAUGUUCUUUUGACGGGCAUCUUUCUUUGCUACAUCAUCACUUUCCUGAUGAUUGCCAAACCAGAUGUGGCAGUGUGUUCUUUCCGGCGAGUUUUCUUGGGCUUGGGUAUGUGCAUCAGUUAUGCAGCCCUCUUGACGAAAACAAAUCGGAUUUAUCGCAUAUUUGAGCAGGGCAAGAAAUCAGUAACAGCUCCCAGACUCAUAAGCCCAACAUCACAACUGGCAAUCACUUCCAGUUUAAUAUCAGUUCAGCUUCUAGGGGUGUUCAUUUGGUUUGGUGUUGAUCCACCCAACAUCAUCAUAGACUAUGAUGAACACAAGACAAUGAACCCUGAGCAAGCCAGAGGGGUUCUCAAGUGUGACAUUACAGAUCUCCAAAUCAUUUGCUCCUUGGGAUAUAGCAUUCUUCUCAUGGUCACAUGUACUGUGUAUGCCAUCAAGACUCGGGGUGUACCCGAGAAUUUUAACGAAGCCAAGCCCAUUGGAUUCACUAUGUACACGACAUGUAUAGUAUGGCUUGCCUUCAUUCCAAUUUUUUUUGGCACCGCUCAAUCAGCGGAAAAGCUCUACAUACAAACUACCACGCUUACAAUCUCCAUGAACCUAAGUGCAUCAGUGGCGCUGGGGAUGCUAUACAUGCCGAAAGUGUACAUCAUCAUUUUCCACCCUGAACUCAAUGUCCAGAAACGGAAGCGAAGCUUCAAGGCGGUAGUCACAGCAGCCACCAUGUCAUCGAGGCUGUCACACAAACCCAGUGACAGACCCAACGGUGAGGCAAAGACCGAGCUCUGUGAAAACGUAGACCCAAACAUUUUUUUUUUUGGCUGUACAGUGGAACUUGGAUUACACUUUAAAUUAACUUUCUCUAGGAAUCAAAGUAACCUCUGA",
        -954.30,
    ),
    "ENSG00000220211": (
        "AUGACAUCAGUCAUACCAGUGAAGGACAAGAAACAUCUGGAGGUCAAACUAGGGGAGCUGCCAAGCUGGAUCUUGAUGCAGGAUCGAGUCAUUGCCGCAGGGAUUCAAAGAGGUUACUACUGGUACUACAACAAAUACAUCAACGUGAAGAAGGGGAGCAUCUCGGGGCUGACCAUGGUGCUGGCAGGCUACAUGCUCUUCCGAUACUGCCUUUCCUACAAGGAGCUCAAGCACAAGCGGCUAUGCAGGUACCACUGA",
        -68.57,
    ),
    "ENSMUSG00000066041": (
        "AUGCACACAGAGUUGUGCACACGCAGCCAUGUCCCCAACACUAGCAAUGUCACUUCAGUCAUGACACAGCUUCAGGUAUGCAGUUCCACACUGAGACACACACAGGCAUCCAAAAGCACUGAUUUGGUUCACAUGUCACGCGUGACAGAAACCUCACCUAUCUGGACACGCACAAUAAAAAAUGUCCAUUCGUUGAGCAGGGCAUUGGUGGCACAUGCCUUUAAUCCCAGCACUUGGGAGGCAGAGGCAGGCAGAUUUCUGAGUUCAAGGCCAUCCUGGUCUACGAAUUUACAACCAGCCUGCGGGACCCCAGAAUCCACAUAG",
        -87.54,
    ),
    "ENSMUSG00000039419": (
        "AUGGUGAUGUCUCUGAGAGCAGGCUACAGGGCAGCGCUCUCGCUCUGGAUUCUCAGCAGCUUCAUCUGCAGAGCCUGGACAGCUCCCUCCACGUUCCAAAAAUGUGAUGAGCCUCUCAUCUCUGGUCUUCCCCAUGUGUCCUUCAGCAGCUCUUCCUCCCUGUCCAGCAGCUAUGCACCUGGUUAUGCCAAGAUUAAUAAACGAGGAGGUGCUGGGGGAUGGUCUCCAUCAGACAGUGACCACUAUCAAUGGCUUCAGGUUGAUUUUGGUAAUCGGAAGCAGAUCAGUGCCAUUGCAACCCAAGGAAGGUACAGCAGUUCUGAUUGGGUGACACAAUAUCGAAUGCUCUACAGUGACACAGGGAGAAACUGGAAACCCUAUCAUCAAGAUGGCAAUAUCUGGGCUUUUCCAGGAAACGUCAAUUCUGACAGCGUGGUCCGACACGACCUGCAGCAUGCAGUAGUUGCCCGUUAUGUACGCGUUGUGCCCUUGGACUGGAAUGGAGAAGGUCACAUCGGGCUGCGUGCGGAAGUCUAUGGCUGCGCCUACUGGGCUGACGUUAUCAACUUUGAUGGCCACGGUGUGUUACCAUAUCGAUUCAGAAACAAGAAGAUGAAAACACUCAAAGAUGUUAUUGCUUUGAAAUUUAAGACCUCUGAAAGUGAAGGAGUACUUUUGCAUGGUGAAGGACAGCAAGGGGAUUACAUUACUUUGGAACUGAAAAAAGCAAAGCUGGUCCUCAGUUUAAAUCUAGGUUUCAACCAGCUUGGCCCCAUCUAUGGCCACACAUCUGUGACAUCUGGGAGCCUGCUGGAUGAUCACCACUGGCACUCUGUACUCAUUGAGCGCCAGGGACGCAGCAUUAACUUGACCCUGGACAGGAGCAUGCAGCAUUUUCGCACCAAUGGAGAGUUUGACUACCUGGACUUGGACUAUGAGAUAACAUUUGGAGGCAUACCUUUCUCUGGUAAGCCAAGUUCCAGUAAUAGGAAGAACUUCAAGGGCUGCAUGGAAAGCAUCAACUACAAUGGUGUCAAUAUUACCGAUCUUGCCCGAAGAAAGAAAUUAGAGCCAUCAAAUAUGGGGAAUCUGAGUUUCUCUUGUGUGGAGCCCUAUACAGUACCAGUCUUCUUCAAUGCUACAAGCUACCUGGAGGUACCUGGCAGACUUAAUCAGGACCUGUUCUCAGUCAGUUUCCAGUUUAGGACUUGGAACCCCAGCGGUCUCUUGCUCUUCAGUCACUUUGCAGAUAACUUGGGCAAUGUGGAGAUUGACCUUGUAGAGAGCAAAGUGGGCGUCCACAUAAACAACACACAGACCAAGACAAGCCAAAUUGACAUCUCCUCAGGCUCCGGGCUGAAUGAUGGGCAGUGGCAUGAGGUUCGCUUCCUGGCCAAGGAAAACUUCGCAGUCCUCACCAUUGAUGGAGAUGAAGCAUCAGCAGUUCGGACCAAUAGUCCUCUUCAAGUGAAGACUGGCGAGAAAUACUUCUUUGGAGGAUUUCUGAACCACAUGAACAAUGCCAGCUACUCUGCCCUUCAGCCAUCAUUCCAAGGAUGCAUGCAGCUCAUUCAGGUAGAUGACCAGCUUGUGAAUUUAUACGAAGUAGCACACAGGAAGCCAGGAAGCUUCGCAAAUGUCACCAUUGACAUGUGUGCCAUCAUAGACAGAUGUGUGCCCAAUCACUGUGAGCAUGGUGGAAAGUGCUCGCAAACAUGGGACAGCUUCAAAUGCACUUGUGAUGAGACAGGAUACAGCGGGGCCACCUGCCACAACUCCAUCUACGAGCCCUCCUGUGAAGCAUACAAACACCUUGGCCAGACAUCAAAUUACUACUGGAUAGAUCCUGAUGGCAGUGGACCACUGGGGCCUCUGAAGGUUUAUUGCAACAUGACAGAGGACAAGGUGUGGACCAUAGUGUCUCAUGACUUACAGAUGCAGACGACAGUGGUAGGCUACAACCCAGAAAAGUACUCUGUGACACAGCUUAUCUACAGUGCCUCCAUGGACCAGAUUAGUGCCAUCACCAGUAGCGCCGAGUACUGCGAACAGUACGUCUCCUACUUCUGCAGGAUGUCCAGGUUGUUGAACACCCCAGAUGGAAGUCCUUACACCUGGUGGGUUGGCAAAGCCAAUGAGAAGCACUACUACUGGGGAGGAUCAGAGCCUGGAAUUCAGAAGUGUGCCUGUGGCAUAGAGCGCAACUGCACAGAUCCCAAGUACUACUGCAACUGUGAUGCUGACUACAAGCAGUGGAGGAAGGAUGCUGGCUUCUUAUCCUACAAAGAUCACCUGCCAGUGAGCCAGGUGGUGGUUGGAGAUACUGACCGACAAGGCUCAGAAGCCAAGCUGAGUGUGGGUCCCCUGCGCUGCCAAGGAGACAGAAAUUAUUGGAAUGCUGCCUCCUUCCCAAACCCAUCAUCCUACCUGCACUUCUCUACCUUCCAAGGGGAAACAAGUGCUGACAUUUCUUUCUACUUCAAGACAUUAAUCCCCAGGGGAGUAUUUUUGGAAAAUCUGGGGAACACAGACUUCAUCAAGCUGGAGCUCAAGUCUGCCACAGAAGUGUCCUUUUCAUUUGAUGUUGGAAACGGGCCAGUGGAGAUCGUGGUGAGGUCACCUUCACCUCUCAAUGAUGACCAGUGGCAUCGGGUCACUGCAGAGAGGAAUGUCAAGCAGGCCAGUCUCCAGGUGGAUCGCCUGCCCCAGCAAAUCCGAAAAGCCCCGACUGAAGGUCAUACCCGCCUGGAACUCUACAGUCAGCUGUUUGUUGGUGGUGCUGGAGGCCAGCAGGGCUUCCUAGGCUGCAUCCGCUCCUUGAGGAUGAAUGGAGUAACACUUGACUUGGAAGAAAGGGCGAAGGUCACAUCUGGGUUCAAGUCUGGAUGCUCAGGCCACUGCACCAGCUAUGGGGCUAACUGUGAAAAUGGAGGCAAAUGCAUCGAAAAAUACCAUGGCUACUCCUGCGACUGCUCUAACACAGCCUAUGAUGGGACAUUCUGCAACAAAGAUGUUGGUGCCUUUUUUGAAGAAGGCAUGUGGCUGCGCUAUAACUUCCAGGCCCCAGCGGUCACUGCCAGAGACACAGGCAGCAGGGCCGAGAAUUCUGCAGACCAGCAGCAGCACUUGGCUCCAGAUCUGGCCCAGGAGCAGAUCCACUUUAGCUUCAGCACUACCAAGGCACCCUGCAUCCUCCUCUAUGUCAGCUCCCUCACCACUGACUUCCUAGCUGUUCUGGUCAAGCCCACAGGAAACUUGCAGAUCCGGUAUAACCUGGGAGGAACCAGAGAGCCAUUCAAUAUUGACGUAGACCACAGGAACAUGGCCAAUGGACAGCCGCACAGUGUCAACAUCACCCGGCAUGAGAGGACCAUAAUUCUCAAGCUCGACCAUUAUCCUGCUGUGGGUUACCAUCUACCCAGCUCCUCUGAUACGCUCUUCAAUUCUCCCAAGUCGCUCUUCCUUGGAAAAGUUAUAGAAACGGGAAAAAUCGACCAAGAAAUUCACAAAUACAACACCCCAGGCUUCACAGGCUGCCUGUCCAGAGUCCAGUUCAACCACAUCGCCCCUCUCAAGGCAGCCUUGAGACAGACAAACGCCUCAGCCCACGUGCACAUUCAGGGUGAGCUGGUGGAAUCUAACUGCGGGGCCUCCCCACUGACGCUUUCCCCCAUGUCUUCAGCCACUGACCCUUGGCACCUAGAUCACUUGGAUUCAGCCAGUGCUGAUUUCCCAUAUAACCCAGGACAAGGCCAAGCUAUAAGAAAUGGAGUCAACAGAAACUCAGCUAUCAUUGGAGGGGUCAUCGCUGUGGUGAUUUUCACCAUCCUCUGCACCCUGGUCUUCCUCAUCCGGUACAUGUUCCGUCACAAGGGCACCUACCACACCAAUGAGGCCAAGGGAGCUGAGUCAGCCGAGAGUGCAGAUGCUGCCAUCAUGAACAACGACCCCAACUUCACAGAGACCAUUGACGAGAGCAAAAAGGAGUGGCUCAUUUGA",
        -1364.76,
    ),
    "ENSMUSG00000022456": (
        "AUGUCUGAGCUGGUACCUGAGCCCAGGCCUAAGCCGGCGGUGCCCAUGAAGCCGGUCAGCAUCAACUCCAACCUGCUAGGCUACAUUGGCAUUGACACCAUUAUCGAGCAGAUGCGCAAGAAGACCAUGAAGACUGGCUUUGACUUCAACAUCAUGGUCGUUGGCCAGAGUGGACUGGGCAAGUCAACACUGGUCAACACCCUCUUCAAGUCCCAAGUGAGCCGAAAGGCCUCCAGCUGGAACCGGGAGGAGAAGAUCCCCAAGACAGUGGAGAUCAAAGCGAUUGGGCAUGUGAUAGAGGAAGGUGGUGUCAAAAUGAAGCUGACAGUCAUCGACACACCAGGCUUUGGAGACCAGAUCAACAAUGAAAACUGCUGGGAGCCCAUUGAGAAAUACAUCAACGAACAGUACGAAAAGUUCCUGAAGGAGGAGGUGAACAUUGCCAGGAAGAAACGCAUCCCUGACACCCGUGUCCACUGCUGCCUCUACUUCAUCUCCCCGACAGGACACUCCUUACGACCACUGGAUCUUGAGUUCAUGAAACAUCUCAGCAAAGUGGUGAACAUCAUUCCUGUCAUUGCCAAGGCUGAUACCAUGACCCUGGAGGAGAAGUCGGAAUUCAAGCAGAGGGUGAGAUUCUACCCUCAGAAGGAAUUUGAUGAGGAUUUGGAGGACAAGACAGAGAAUGACAAAAUCCGGCAGGAGAGCAUGCCCUUCGCCGUGGUGGGGAGUGACAAGGAGUACCAAGUGAACGGCAAGAGGGUCCUCGGGAGGAAAACACCCUGGGGGAUCAUCGAAGUGGAAAACCUCAACCACUGUGAGUUUGCCCUGCUCCGAGACUUCGUCAUCAGGACUCACCUCCAGGACCUCAAAGAAGUAACACACAACAUCCACUAUGAGACUUACAGGGCCAAGAGGCUCAAUGACAAUGGAGGCCUCCCUCCGGUGAGCGUGGACACAGAGGAAACGACAGUAACCCGUGCCCUUCUCUGUGUUAUCAUACAUAUCCCCCUUCUCCAAACACACACACAUCCUAGAUACCACAGCCACCACCUCCUCUCAGCUCUGUCCCCCAGGCCUGUCUGGUAUUUGUGCAGUAUUUUGUCUAGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUGUAUGUAUGUGUGUAUGUGUGUGAUGGAGAGUGCCUGCGUGUAUGUGUGUGUGAUGGAGAGUGCCUGUGUGUGUGUAUGCAUGUGUGUGUAUGUAUGCGUGUACUCAGGGGUGAGGUAUUUUCAUUGCCCUCUUUGGAAAGUCCUUUGUAAGUCUGCUUUCUCCAUGACUCUCCAUUCUGUCUCCUUUUUUCUUGUGCUCCAGAACAAAAAGCUGUGCGCCUCACUCAAGAGGUCUGGGGAAGGUUUUAAUUUAUAA",
        -474.88,
    ),
    "ENSMUSG00000030046": (
        "AUGGGGUCUCUGGUUCUGCCGCUGAGCGCCGUCUUCUGCCUGGUGGCUCACUCGGCUUCUGGCAGCCCCAUUAUGGGCCUUGAGCAGUCGCCCCUGGAAGAAGACAUGCCCUUCUUUGAUGAUAUCUUCACGGAGCAAGAUGGUAUUGACUUCAACACACUGCUGCAGAGCAUGAAGAACGAGUUUCUCAAGACGCUGAACUUGUCGGACAUUCCUGUGCAGGACACGGGCAGAGUGGAUCCACCAGAGUACAUGCUGGAGCUCUACAACAAAUUCGCCACAGACCGGACCUCCAUGCCGUCUGCUAACAUCAUCCGGAGCUUCAAGAACGAACUGUUUUCUCAACCAGUCACUUUUAAUGGGCUCCGGAAAUAUCCUCUCCUCUUCAAUGUGUCUAUCCCUCACCAUGAAGAGGUCGUCAUGGCUGAACUGCGGUUGUACACGCUGGUGCAGAGAGAUCGCAUGAUGUAUGAUGGCGUGGACCGUAAAAUUACCAUUUUUGAGGUACUAGAGAGUGCAGACGGUAGCGAGGAGGAGAGGAGCAUGCUGGUCUUAGUAUCAACAGAGAUCUACGGAACCAACAGUGAGUGGGAGACAUUUGACGUCACAGAUGCCACCAGACGUUGGCAAAAGUCAGGCCCAUCAACCCAUCAGCUGGAGAUCCACAUAGAAAGCAGACAAAACCAAGCUGAGGACACCGGAAGGGGACAACUGGAAAUAGAUAUGAGUGCCCAAAAUAAGCAUGACCCUUUGCUGGUUGUGUUUUCUGAUGACCAAAGCAAUGACAAGGAGCAGAAAGAAGAACUGAACGAAUUGAUCACCCAUGAGCAGGAUCUGGACCUGGACUCAGAUGCUUUCUUCAGUGGGCCCGAUGAAGAGGCUCUGCUGCAGAUGAGGUCGAACAUGAUUGAUGAUUCGUCCGCUCGGAUCAGGAGGAACGCCAAGGGGAACUACUGUAAGAAGACCCCACUAUACAUCGACUUCAAGGAGAUUGGGUGGGACUCCUGGAUCAUCGCUCCUCCUGGGUAUGAAGCCUAUGAGUGCCGGGGUGUGUGUAACUACCCUCUGGCGGAGCACCUCACACCUACAAAACACGCAAUUAUUCAGGCCUUGGUCCACCUCAAGAAUUCCCAGAAAGCUUCCAAAGCCUGCUGUGUGCCCACGAAGCUGGAUCCCAUCUCCAUCCUCUAUUUAGAUAAAGGUGUCGUCACCUACAAGUUUAAAUAUGAAGGGAUGGCUGUGUCUGAGUGUGGCUGUAGAUAG",
        -424.02,
    ),
    "ENSMUSG00000056696": (
        "AUGGCCAAUCUCUCCACAGUGUCUGUGUUCAUUCUCCAGGGCUUCUCUGCUGUUCCUGCAUUACAGUUGCUGAGCAUGGCCAUCUUUCUUCUCAUAUACCUGGCUGCGGUUCUGGGGAAUGUCUCUAUCAUGAUAGCUGUGACUCUUGACUCCCAUCUGCACACACCCAUGUACUUCUUCAUCAAACACCUCUCCCUAGUGGAUCUCUGUUCUACAUCCACCACCCUGCCUCGGGCCCUGGUGGCUACCAUGGCAGACACCAAAGAGAUAUCCCUCCCAGCCUGUGCAUCUCAACUCUUUGCUUUUGUCUGCUUUGGCUCUCUGGAAUGUUUUCUCAUCACUGCCAUGGCUUUUGACCGCUGUCUAGCCAUCUACAGACCCCUGACAUAUGGGGUAACCAUGAGUUCUCAGACCUGUGUGUCCCUGGUAGUGGUGGCCUGGGUCAGUGGACUCCUCUUUUCUACCUUCCACAUGGUCAACACUUUCUCCUUGCCCUUCUGUGGUCCCAACAUGAUUGAUCACUUCUUCUGUGACAUCCCCCCACUCAUGCAUCUAGCUUGUGGUGACACCCAAGGCCAUGAGGCUGCAGGUUUUAUAGUUAGUGGAUGUGUCAUCAUGACUUGCUUUGCCCUCACUUGCCUGUCUUAUGUUCUUAUUGUAUACACAGUGGUUCACAUCCGUUCUGCAGCUGGCCGCUGGAAGGCCUUCUCCACGUGUUCCUCCCAUCUGGCCACAGUGCUUCUGUUUUAUGGCACUGGAAGUUCAGCCUACAUGCAGCCCACAGCCCACUACUCCCCACUGCAAGGGCGCAUGGCCGCCAUAUUCUAUUCUAUCCUCAUGCCAACUCUGAAUCCACUUAUCUACAGCCUCAGAAACAAGGACAUGAAAGCAGCUCUGCGGAAGCUUUAUCCACAGGUGCCAUCCUAG",
        -297.92,
    ),
    "ENSMUSG00000022112": (
        "AUGGAUGCCCGCACCUGGCGUCUGGGCUGGCGCUGUCUCCUUCUCCUGGCUCUCCUUGGAUCUACCCGAAGCGAGGGCGUGGAGAGCUGCGAAGAAGUUCGGAAACUUUUCCAGUGGCGGCUUGGGGGAGCUGUCAAAGGGCUGCCGGAGGCGCCGCGGGCAGGACCUGAUCUUCAGGUUUGCCUAUCCAAAAACCCAACGUGCUGUACCAGGAAGAUGGAGGAGAGGUACCAGAUUGCAGCUCGGCAAGAUUUGCAGCAGGUGCUUCAGACAUCCAGCUCAACAUUAAAGUUGCUAAUAUCUCGAAAUGCAGCUGCUUUUCAAGAGACCCUGGAAACCCUCAUCAGACAAGCAGAGAAUUACACCAGUAUCCUUUUCUGCAACACCUACCGGAACAUGGCCUUGGAGGCUGCUGCUUCCAUUCAGGAAUUUUUCACGGAUGUUGGACUCUAUUUAUUUGGUGCGGAUGUUAAUCCCGAGGAAUUUGUAAACAGAUUCUUUGACAGUCUUUUUCCUCUGGUCUACAACCAUCUUAUAAACCCUGGUGUGACUGACAGUUCUCUGCAAUACUCAGAAUGCAUUCGAAUGGCCCGCCAGGAUGUUAGUCCAUUUGGCAACAUUCCCAAAAGAGUCAUGGGGCAGAUGGGGAGGUCGCUGCUGCCUGGCCGCACAUUCUUGCAGGCGCUUAAUCUGGGCAUUGAGGUCAUCAACACCACGGACCACAUACACUUCUCCAAGGAGUGCAGUAGGGCCCUCCUGAAGAUGCAGUAUUGUCCUCACUGCCAGAGCCUGAUGCUCAGUAAGCCCUGUAUGGGGUACUGCCUCAAUGUCAUCAGGGGCUGCCUGGCCCACAUGACUGAGCUUAAUCCACACUGGCAUGCUUAUAUCCGGUCUUUGGAAGAGUUGUCAGAUGCGAUGCACGGAACCUACGACGUUGAACACGUGCUCCUGAACUUCCACUUGCUUGUUAAUGAUGCCGUGUUGCAGGCUCACCUCAAUGGGCAGAAAUUAUUGGAUCAGGUGAAUACGAUUUGUGGCCAUCCAGUGAGAACACCAACACAGAGCCCCCGCUGUACUUUUGACCCAAGCAAAGAGAAACAUGGAAUGAAGAUCUCUGCAAGGAAUGGUGAAGAGACACUUGCCAACAGAAGAAAAGAAUUCAUCAAUAGCCUUAGGCUGCAUGGGUCCUUCUAUGGUGGCCUGGCUGACCAGCUUUGUGUUAAUGAAUUGGCUGCCCCUGAAGGAAGGCCCUGCUGGAAUGGGGAGGAAAUAGUCAAAAGCUAUGCUCAGCGUGUGGUUGGGAAUGGAAUCAAAGCCCAGUCUGCAAAUCCUGAAGUCAGAGUCAGAGGAACCGAUCCUGUGGUAAAUCAGAUCAUUGAUAAACUGAAGCAUGUCAUCCAGUUGUUACGGGGGAGAUCACCCAAGCCCAACAAGUGGGAGCUCCUUCAGCCAGGCAGUGGAGGCGGCAUGCUUGAGAACUCUAGUGGAGACUGUGAUGACGAAGAUGGCUGUGGAGGAUCAGGAAGCGGAGAAGUAAAGAGGACCCUGAAGAUCACAAACUGGAUGCCAGACAGCAUGAACUUCAGUGAUGUGAAGCAAGUCCAUCGAGCAGACCAUGGAAGUACUCUGGAUACAACCAGCACCGGAUGUGCGUCAGGAACUGAGUCUAUGGCACUCCCUCUGAUGGGGACACUGAUGUUUCUUCCCUGGCUUUGGUAA",
        -594.26,
    ),
}


def _to_raw_energy(energy: float) -> float:
    """Raw energy values in the supplementary data had been transformed to fit RNAfold.
    This function reverses that transformation.
    """
    return energy * 0.456 - 8.215


@pytest.mark.parametrize("name", TEST_DATA.keys())
def test_pseudo_minimum_free_energy(name):
    sequence = TEST_DATA[name][0]
    pseudo_minimum_free_energy = _to_raw_energy(TEST_DATA[name][1])
    assert Sequence.create(sequence).pseudo_minimum_free_energy == pytest.approx(
        pseudo_minimum_free_energy,
        rel=2e-2,  # Accurate to within 2%
    )


@pytest.mark.parametrize("name", TEST_DATA.keys())
def test_windowed_minimum_free_energy(name):
    sequence = TEST_DATA[name][0]
    assert Sequence.create(sequence).windowed_minimum_free_energy().mean_energy < 0
